
<md-grid-list cols="4" rowHeight="fit">
    <md-grid-tile class="toolbar">
        <div *ngIf="model && modelLayout && modelLayout.initialized" class="toolbar-inner">

            <md-toolbar color="primary">
                <span class="spacer">Db Diagram</span>
                <button type="button" md-icon-button (click)="saveLayout()" mdTooltip="Save layout">
                    <md-icon>save</md-icon>
                </button>
                <button type="button" md-icon-button (click)="restoreLayout()" mdTooltip="Load layout">
                    <md-icon>folder_open</md-icon>
                </button>
            </md-toolbar>

            <div class="spacer toolbar-content">
                <md-toolbar>
                    <span class="spacer">Entities</span>

                    <button
                        type="button"
                        md-icon-button
                        (click)="toggleAllEntitiesVisibility()">
                        <md-icon *ngIf="modelLayout.visibleEntities.length > 0">visibility</md-icon>
                        <md-icon *ngIf="modelLayout.visibleEntities.length === 0">visibility_off</md-icon>
                    </button>
                </md-toolbar>
                <md-nav-list class="entities-list" dense>
                    <md-list-item *ngFor="let entity of modelLayout.entities">
                        <md-icon md-list-icon>web_asset</md-icon>
                        <a href="javascript:void(0);" md-line>
                            {{ entity.entity.shortName }}
                        </a>
                        <button
                            type="button"
                            md-icon-button
                            (click)="toggleEntityVisibility(entity); $event.stopPropagation()">
                            <md-icon *ngIf="entity.visible">visibility</md-icon>
                            <md-icon *ngIf="!entity.visible">visibility_off</md-icon>
                        </button>
                    </md-list-item>
                </md-nav-list>

                <md-toolbar>
                    <span class="spacer">Entity Settings</span>
                </md-toolbar>
                <section>
                    <h4>Properties Table Columns</h4>
                    <div *ngFor="let column of modelLayout.entitiesTableSettings.columns">
                        <md-slide-toggle
                            [checked]="column.visible"
                            (change)="column.toggleVisibility()"
                            [disabled]="column.alwaysVisible">
                        </md-slide-toggle>
                        <md-input-container>
                            <input
                                type="text"
                                mdInput
                                [placeholder]="'Column title - ' + column.key"
                                [(ngModel)]="column.name">
                        </md-input-container>
                    </div>
                </section>
            </div>

            <efd-scaling-toolbar [(scale)]="modelLayout.currentScale.scale"></efd-scaling-toolbar>
        </div>
    </md-grid-tile>
    <md-grid-tile colspan="3" class="diagram">
        <md-spinner *ngIf="modelLoading"></md-spinner>

        <ng-container *ngIf="modelLoadError">

            <h1>Failed to load database model.</h1>

            <pre>
                {{ modelLoadError }}
            </pre>
        </ng-container>

        <efd-db-diagram *ngIf="!modelLoading && !modelLoadError" [model]="model"></efd-db-diagram>
    </md-grid-tile>
</md-grid-list>
